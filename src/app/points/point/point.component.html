<div *ngIf="!editing" class="BT">

  <div [innerHTML]="point.pointHTML" [ngClass.xs]="'ugc xs'" [ngClass.sm]="'ugc sm'" [ngClass.gt-sm]="'ugc'"></div>

  <div class="youTube" *ngIf="point.youTubeID">
    <iframe [src]="'https://www.youtube.com/embed/' + point.youTubeID | SafeURL" allowfullscreen></iframe>
  </div>

  <!-- Can only see quote source if Feedback given. Can view link for all recommended point types -->
  <div *ngIf="point.pointFeedback.feedbackGiven || recommended" 
    class="pointSource" [ngClass.lt-md]="'ltmd'">
    <a *ngIf="point.url" [href]="point.url" target="_blank">{{ point.source }}</a>
    <span *ngIf="!point.url">{{ point.source }}</span>
  </div>



  <mat-toolbar fxLayoutAlign="space-around center">

    <div>

      <button mat-icon-button [matMenuTriggerFor]="pointTypeVote" type='button'>
        <mat-icon *ngIf="point.pointTypeID===PointTypesEnum.Opinion" matTooltip="Opinion">record_voice_over</mat-icon>
        <mat-icon *ngIf="point.pointTypeID===PointTypesEnum.Fact" matTooltip="Fact">school</mat-icon>
        <mat-icon *ngIf="point.pointTypeID===PointTypesEnum.Action" matTooltip="Action">directions_walk</mat-icon>
        <mat-icon *ngIf="point.pointTypeID===PointTypesEnum.Quote" matTooltip="Quote">format_quote</mat-icon>
        <mat-icon *ngIf="point.pointTypeID===PointTypesEnum.ReportOrSurvey" matTooltip="Report or Survey">description</mat-icon>
        <mat-icon *ngIf="point.pointTypeID===PointTypesEnum.Petition" matTooltip="Petition">create</mat-icon>
        <mat-icon *ngIf="point.pointTypeID===PointTypesEnum.RecommendedReading" matTooltip="Recommended Reading">local_library</mat-icon>
        <mat-icon *ngIf="point.pointTypeID===PointTypesEnum.RecommendedViewing" matTooltip="Recommended Viewing">video_library</mat-icon>
        <mat-icon *ngIf="point.pointTypeID===PointTypesEnum.RecommendedListening" matTooltip="Recommended Listening">video_library</mat-icon>
        <mat-icon *ngIf="point.pointTypeID===PointTypesEnum.Assumption" matTooltip="Assumption">crop</mat-icon>
        <mat-icon *ngIf="point.pointTypeID===PointTypesEnum.Belief" matTooltip="belief">speaker_notes</mat-icon>
        <mat-icon *ngIf="point.pointTypeID===PointTypesEnum.Anecdote" matTooltip="Anecdote">hearing</mat-icon>
        <mat-icon *ngIf="point.pointTypeID===PointTypesEnum.Tweet" matTooltip="Tweet">reply</mat-icon>
        <mat-icon *ngIf="point.pointTypeID===PointTypesEnum.CommonSense" matTooltip="Common Sense">how_to_reg</mat-icon>
        <mat-icon *ngIf="point.pointTypeID===PointTypesEnum.RhetoricalQuestion" matTooltip="Rhetorical Question">not_listed_location</mat-icon>
        <mat-icon *ngIf="point.pointTypeID===PointTypesEnum.Definition" matTooltip="Definition">notes</mat-icon>
        <mat-icon *ngIf="point.pointTypeID===PointTypesEnum.Meaning" matTooltip="Meaning">functions</mat-icon>
        <mat-icon *ngIf="point.pointTypeID===PointTypesEnum.Prediction" matTooltip="Prediction">timeline</mat-icon>
      </button>

      <mat-menu #pointTypeVote="matMenu">

        <button mat-menu-item (click)="PointTypeVote(PointTypesEnum.Opinion)" [ngClass]="{selected:point.pointTypeID===PointTypesEnum.Opinion}">
          <mat-icon>record_voice_over</mat-icon> opinion
        </button>

        <button mat-menu-item (click)="PointTypeVote(PointTypesEnum.Fact)" [ngClass]="{selected:point.pointTypeID===PointTypesEnum.Fact}">
          <mat-icon>school</mat-icon> fact
        </button>

        <button mat-menu-item (click)="PointTypeVote(PointTypesEnum.Action)" [ngClass]="{selected:point.pointTypeID===PointTypesEnum.Action}">
          <mat-icon>directions_walk</mat-icon> action
        </button>

        <button mat-menu-item (click)="PointTypeVote(PointTypesEnum.Quote)" [ngClass]="{selected:point.pointTypeID===PointTypesEnum.Quote}">
          <mat-icon>format_quote</mat-icon> quote
        </button>

        <button mat-menu-item (click)="PointTypeVote(PointTypesEnum.ReportOrSurvey)" [ngClass]="{selected:point.pointTypeID===PointTypesEnum.ReportOrSurvey}">
          <mat-icon>description</mat-icon> report or survey
        </button>

        <button mat-menu-item (click)="PointTypeVote(PointTypesEnum.Petition)" [ngClass]="{selected:point.pointTypeID===PointTypesEnum.Petition}">
          <mat-icon>create</mat-icon> petition
        </button>

        <button mat-menu-item (click)="PointTypeVote(PointTypesEnum.RecommendedReading)" [ngClass]="{selected:point.pointTypeID===PointTypesEnum.RecommendedReading}">
          <mat-icon>local_library</mat-icon> recommended reading
        </button>

        <button mat-menu-item (click)="PointTypeVote(PointTypesEnum.RecommendedViewing)" [ngClass]="{selected:point.pointTypeID===PointTypesEnum.RecommendedViewing}">
          <mat-icon>video_library</mat-icon> recommended viewing
        </button>

        <button mat-menu-item (click)="PointTypeVote(PointTypesEnum.RecommendedViewing)" [ngClass]="{selected:point.pointTypeID===PointTypesEnum.RecommendedListening}">
          <mat-icon>video_library</mat-icon> recommended listening
        </button>

        <button mat-menu-item (click)="PointTypeVote(PointTypesEnum.Assumption)" [ngClass]="{selected:point.pointTypeID===PointTypesEnum.Assumption}">
          <mat-icon>crop</mat-icon> assumption
        </button>

        <button mat-menu-item (click)="PointTypeVote(PointTypesEnum.Belief)" [ngClass]="{selected:point.pointTypeID===PointTypesEnum.Belief}">
          <mat-icon>speaker_notes</mat-icon> belief
        </button>

        <button mat-menu-item (click)="PointTypeVote(PointTypesEnum.Anecdote)" [ngClass]="{selected:point.pointTypeID===PointTypesEnum.Anecdote}">
          <mat-icon>hearing</mat-icon> anecdote
        </button>

        <button mat-menu-item (click)="PointTypeVote(PointTypesEnum.Tweet)" [ngClass]="{selected:point.pointTypeID===PointTypesEnum.Tweet}">
          <mat-icon>reply</mat-icon> tweet
        </button>

        <button mat-menu-item (click)="PointTypeVote(PointTypesEnum.CommonSense)" [ngClass]="{selected:point.pointTypeID===PointTypesEnum.CommonSense}">
          <mat-icon>how_to_reg</mat-icon> common sense
        </button>

        <button mat-menu-item (click)="PointTypeVote(PointTypesEnum.RhetoricalQuestion)" [ngClass]="{selected:point.pointTypeID===PointTypesEnum.RhetoricalQuestion}">
          <mat-icon>not_listed_location</mat-icon> rhetorical question
        </button>

        <button mat-menu-item (click)="PointTypeVote(PointTypesEnum.Definition)" [ngClass]="{selected:point.pointTypeID===PointTypesEnum.Definition}">
          <mat-icon>notes</mat-icon> definition
        </button>

        <button mat-menu-item (click)="PointTypeVote(PointTypesEnum.Meaning)" [ngClass]="{selected:point.pointTypeID===PointTypesEnum.Meaning}">
          <mat-icon>functions</mat-icon> meaning
        </button>

        <button mat-menu-item (click)="PointTypeVote(PointTypesEnum.Prediction)" [ngClass]="{selected:point.pointTypeID===PointTypesEnum.Prediction}">
          <mat-icon>timeline</mat-icon> prediction
        </button>
      </mat-menu>
    </div>


    <div *ngIf="localData.IsSignedIn()">

      <!-- type='button' https://stackoverflow.com/questions/12319758/clicking-a-button-within-a-form-causes-page-refresh -->
      <!-- https://stackblitz.com/angular/rllvqdkjedar -->
      <button mat-icon-button [matMenuTriggerFor]="pointCommands" type='button'>
        <mat-icon *ngIf="!point.pointFeedback.feedbackGiven" matTooltip="feedback options">menu</mat-icon>
        <mat-icon *ngIf="point.pointFeedback.supportLevelID===-9" matTooltip="Report">report</mat-icon>
        <mat-icon *ngIf="point.pointFeedback.supportLevelID===-1" matTooltip="Oppose">thumb_down</mat-icon>
        <mat-icon *ngIf="point.pointFeedback.supportLevelID===-8" matTooltip="Neutral">sentiment_dissatisfied</mat-icon>
        <mat-icon *ngIf="point.pointFeedback.supportLevelID===1" matTooltip="Support">thumb_up</mat-icon>
        <mat-icon *ngIf="point.pointFeedback.woWVote" matTooltip="Voted up">plus_one</mat-icon>
        <mat-icon *ngIf="point.pointFeedback.isFavourite" matTooltip="Is favourite">favorite_border</mat-icon>
      </button>

      <mat-menu #pointCommands="matMenu">

        <button mat-menu-item *ngIf="point.pointFeedback.feedbackGiven">
          <mat-icon>date_range</mat-icon>
          <span [innerHTML]="point.pointFeedback.feedbackDate | nbsp"></span>
        </button>

        <button mat-menu-item (click)="Report()">
          <mat-icon>report</mat-icon>
          report
        </button>

        <button mat-menu-item (click)="Oppose()">
          <mat-icon>thumb_down</mat-icon>
          oppose
        </button>

        <button mat-menu-item (click)="Neutral()">
          <mat-icon>sentiment_dissatisfied</mat-icon>
          neutral
        </button>

        <button mat-menu-item (click)="Support()">
          <mat-icon>thumb_up</mat-icon>
          support
        </button>

        <button mat-menu-item (click)="WoW()">
          <mat-icon>plus_one</mat-icon>
          vote up
        </button>

        <button mat-menu-item (click)="favourite()">
          <mat-icon>favorite_border</mat-icon>
          add to favourites
        </button>

        <button mat-menu-item (click)="anon()">
          <mat-icon>lock</mat-icon>
          anonymous feedback
        </button>

        <button mat-menu-item [matMenuTriggerFor]="shareCommands">
          <mat-icon>share</mat-icon>
          share
        </button>

      </mat-menu>

      <mat-menu #shareCommands>
        <button mat-menu-item>
          <mat-icon>email</mat-icon>
          email address
        </button>
        <button mat-menu-item>
          <mat-icon>people</mat-icon>
          facebook
        </button>
      </mat-menu>

    </div>

    <div fxFlex="80" [ngClass.xs]="'tagsXSmall'" [ngClass.gt-xs]="'tagsLarge'">
      <span>
        <a *ngFor="let slashTag of slashTags" class="slashTag" (click)="altSlashTagSelect(slashTag)">{{ slashTag }}</a>
      </span>
      <span [innerHtml]="point.DateTimeUpdated | nbsp"></span>
    </div>

    <div *ngIf="localData.IsSignedIn() && point.isPointOwner">

      <button mat-icon-button [matMenuTriggerFor]="pointOwnerCommands">
        <mat-icon matTooltip="edit">edit</mat-icon>
      </button>

      <mat-menu #pointOwnerCommands="matMenu">

        <button mat-menu-item (click)="edit()">
          <mat-icon>edit</mat-icon>
          edit
        </button>

        <button mat-menu-item (click)="delete()">
          <mat-icon>delete_forever</mat-icon>
          delete
        </button>

      </mat-menu>

    </div>

  </mat-toolbar>


  <div class="fv-error" *ngIf="error != ''">
    {{ error }}
  </div>

</div>


<app-point-edit (CancelEdit)="onCancelEdit($event)" (CompleteEdit)="onCompleteEdit($event)" [(point)]="point" *ngIf="editing"></app-point-edit>
